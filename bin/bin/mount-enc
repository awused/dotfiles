#!/bin/sh

# /usr/home/desuwa/bin/mount-enc
#geli init -s 4096 -K ~/.enc.key /dev/zvol/storage/shadow
#

set -e

sudo geli attach -k ~/.enc.key /dev/zvol/storage/shadow
sudo mount -o nfsv4acls /dev/zvol/storage/shadow.eli /storage/media/users/desuwa
#sudo mount -o nfsv4acls,ro,bind -t nullfs /usr/home/desuwa/git/ /storage/media/users/desuwa-ro/git/
#sudo mount -o nfsv4acls,ro,bind -t nullfs /usr/home/desuwa/go/src/github.com/awused/ /storage/media/users/desuwa-ro/go/src/github.com/awused/
#sudo mount -o nfsv4acls,ro,bind -t nullfs /usr/home/desuwa/backed_up/ /storage/media/users/desuwa-ro/backed_up/
# restart instead of reload in case it failed to start or isn't running for some reason
sudo service mountd restart
#sudo service mountd reload

